import { getAppointments, updateAppointment } from "./firebase.js";

async function loadAppointments(){
    const appointments = await getAppointments();
    const table = document.getElementById('appointmentsTable');
    table.innerHTML=`<tr><th>نام بیمار</th><th>شماره</th><th>بیمارستان</th><th>پزشک</th><th>تاریخ/ساعت</th><th>وضعیت</th><th>عملیات</th></tr>`;
    appointments.forEach(app=>{
        const row = table.insertRow();
        row.insertCell(0).innerText=app.name;
        row.insertCell(1).innerText=app.phone;
        row.insertCell(2).innerText=app.hospital;
        row.insertCell(3).innerText=app.doctor;
        row.insertCell(4).innerText=app.datetime;
        row.insertCell(5).innerText=app.status;
        const actions = row.insertCell(6);
        const approve = document.createElement('button');
        approve.innerText='تایید'; approve.onclick=()=>updateStatus(app.id,'تایید شده');
        const cancel = document.createElement('button');
        cancel.innerText='لغو'; cancel.onclick=()=>updateStatus(app.id,'لغو شده');
        actions.appendChild(approve); actions.appendChild(cancel);
    });
}

async function updateStatus(id,status){
    await updateAppointment(id,status);
    loadAppointments();
}

loadAppointments();
